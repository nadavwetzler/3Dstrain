# OrthoFault
by Nadav Wetzler and Ze'ev Reches

The codes provides a numerical tool to predic the faulting orientation at a 3-D stress state.

We developed a theory of rock faulting that is based on two conditions: Rocks fail under a critical level of elastic energy, and the elastic deformation imposed by the loading system is accommodated by slip and dilation along the developing faultsbased on energy balancing method between the applied stress and internal dissipate energy by faulting.
We use a series of stress states from three dimensional experiments to show the predicted faulting patterns.

# Input
The progrem loads experiment stress data, including the Young modulus and Poisson modules. See 14 datasets in the 'Data' direcory that are obtained from experimental datasets (see reference list).

# Output 
The out put includes the predicted orthorhombic orientations for each experimental stress state.

# To run the code
1) Downlod the package 

2) Use run_OrthoFault.m to run the script

<img width="674" alt="Screen Shot 2022-01-12 at 18 53 20" src="https://user-images.githubusercontent.com/88764899/149185397-c242f9a8-fbf1-44a7-8461-92e11860ae27.png">

# Theory
We consider an intact, homogeneous, linear elastic, brittle rock, at a quasi-static compressional loading system. The bulk elastic strain energy of the tested rock sample, U, is a product of the applied three-dimensional stresses and the elastic moduli of the rock sample. For simplicity, the analysis refers to the principal stress coordinate system. 
It is suggested that the rock failure by shear along one or more faults is controlled by the conditions formulated by these hypotheses: 

A.	Critical energy: Faulting (i.e., shear fracturing) occurs when U ≥ UC, where U is the elastic energy density generated by the loading system, and UC is the critical energy density necessary for dissipation by the faulting processes. We employ the total elastic energy that incorporates both the mean-stress and the distortion-energy because the failure of brittle rocks strongly depends on the mean-stress and normal stress. 

B.	Strain compatibility: The internal strain-state is compatible with the external, elastic strain-state, that is generated by the external loading stresses. The internal strain is accommodated by slip along the developing faults and by dilation normal to them. 


We search for a fault system that satisfy the above two hypotheses. The search is based on simulations of a single preferred fault that is defined by its normal angles with respect to the three-dimensional axes of the principal stress state. At failure, the rock-body is internally deformed by fault slip along the DS axis and dilation DD normal to it. The faulting energy dissipation is the work done by Ds and Dd under the corresponding stresses applied on the preferred fault. The preferred fault geometry is derived here by a multi-parameter minimization of the differences between the external elastic deformation (strain, and energy), and the internal strain and energy dissipation by the fault 

# Flow
The input file for a given dataset includes a table of the three principal stresses at experimental failure, and the Young modulus and Poisson’s ratio parameters of the tested rock. The calculations are conducted in the following steps: 
I) Calculate and plot the general input data: principal stresses, the principal strains e1, e2 and e3 at failure, the stress invariants, I1 and I2, and the elastic energy density during failure, Uc.

II) Guessing an initial preferred fault orientation with slip intensity, DS and dilation, DD. This fault is defined by directional cosines of its normal (N1, N2, N3), and the slip axis is defined by its direction cosines (S1, S2, S3) in the principal stress coordinates.

III) Calculation for the initial preferred fault:
The normal stress across the initial preferred fault, tn, and the shear stress, ts, in the slip direction based on the known stress-state (Sig1, Sig2, Sig3), and the initial fault parameters (Ni, Si) that were guessed in step II.
The internal strain-state due to the slip, DS, and dilation, DD, along the initial preferred fault.
The dissipated work, W, by the fault slip under ts for distance DS, and work against n by dilation DD. 

IV) Steps II and III are repeated in a grid scanning the full range of N1, N2 (0-1), in search for the minimum DS, and DD, for the best-fit preferred fault. We used the Levenberg-Marquardt nonlinear least-squares method. The best-fit fault has these features:  
a. The slip and dilation generate an internal three-dimensional strain-state that equals the elastic strain-state generated by the principal stresses.  
b. The dissipated work by the slip and dilation is smaller than the critical energy, CEFF.   
c. The slip intensity, Ds, is minimized.  

V) The calculations of step IV produced one fault, and due to the symmetry of the stress system, four faults in orthorhombic symmetry have the same stress and strain of the preferred fault, and have equal likelihood to form. This situation is equivalent to the development of a conjugate set of faults under 2D strain loading.
Steps I-V are for one experiment with known stress-state, and calculated strain-state and preferred faults (Fig. 3D). The calculations are then repeated to all experiments in the dataset to produce plots of: (1) the preferred faults with slip axes; a Mohr diagram with ts vs Sig_n of the preferred faults. This plot represents the strength of the analyzed rock according to the present theory. 

# How to cite
Please use:

Reches, Z., and N. Wetzler (2022). An energy-based theory of rock faulting, Earth Planet. Sci. Lett. 597, 117818, doi: 10.1016/j.epsl.2022.117818.

# Datasets

1.	Colmenares, L. B. & Zoback, M. D. A statistical evaluation of intact rock failure criteria constrained by polyaxial test data for five different rocks. Int. J. Rock Mech. Min. Sci. 39, 695–729 (2002).

2.	Katz, O., Gilbert, M. C., Reches, Z. & Roegiers, J.-C. Mechanical Properties of the Mount Scott Granite, Wichita Mountains, Oklahoma. (2001).

3.	Haimson, B. & Chang, C. A new true triaxial cell for testing mechanical properties of rock, and its use to determine rock strength and deformability of Westerly granite. Int. J. Rock Mech. Min. Sci. 37, 285–296 (2000).

4.	Mogi, K. Effect of the intermediate principal stress on rock failure. J. Geophys. Res. 72, 5117–5131 (1967).

5.	Sriapai, T., Walsri, C. & Fuenkajorn, K. True-triaxial compressive strength of Maha Sarakham salt. Int. J. Rock Mech. Min. Sci. 61, 256–265 (2013).

6.	Reches, Z. & Dieterich, J. H. Faulting of rocks in three-dimensional strain fields I. Failure of rocks in polyaxial, servo-control experiments. Tectonophysics 95, 111–132 (1983).

7.	Heesakkers, V., Murphy, S. & Reches, Z. Earthquake Rupture at Focal Depth, Part I: Structure and Rupture of the Pretorius Fault, TauTona Mine, South Africa. Pure Appl. Geophys. 168, 2395–2425 (2011).

8.	Ramsey, J. M. & Chester, F. M. Hybrid fracture and the transition from extension fracture to shear fracture. Nature 428, 63–66 (2004).

9.	Hakami, H. & Stephansson, O. Shear fracture energy of Stripa granite-results of controlled triaxial testing. Eng. Fract. Mech. 35, 855–865 (1990).


